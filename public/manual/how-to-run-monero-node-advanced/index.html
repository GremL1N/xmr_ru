<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Запуск узла Monero (продвинутая версия руководства) - </title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Запуск узла Monero (продвинутая версия руководства)" />
<meta property="og:description" content="Введение​ Принимая во внимание постоянные атаки на сеть Monero, настало время пользователям задуматься о создании собственных узлов.
В этом коротком посте я подробно напишу, как можно без труда запустить узел Monero на сервере Linux, наиболее часто используемой для создания виртуальных приватных серверов (VPS) операционной системы. В качестве дистрибутива Linux я настоятельно рекомендую использовать Debian или Ubuntu. По крайней мере, в рамках данного руководства предполагается, что вы пользуетесь одним из них." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/manual/how-to-run-monero-node-advanced/" /><meta property="article:section" content="manual" />




		<meta itemprop="name" content="Запуск узла Monero (продвинутая версия руководства)">
<meta itemprop="description" content="Введение​ Принимая во внимание постоянные атаки на сеть Monero, настало время пользователям задуматься о создании собственных узлов.
В этом коротком посте я подробно напишу, как можно без труда запустить узел Monero на сервере Linux, наиболее часто используемой для создания виртуальных приватных серверов (VPS) операционной системы. В качестве дистрибутива Linux я настоятельно рекомендую использовать Debian или Ubuntu. По крайней мере, в рамках данного руководства предполагается, что вы пользуетесь одним из них.">

<meta itemprop="wordCount" content="2638">
<meta itemprop="keywords" content="" />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Запуск узла Monero (продвинутая версия руководства)"/>
<meta name="twitter:description" content="Введение​ Принимая во внимание постоянные атаки на сеть Monero, настало время пользователям задуматься о создании собственных узлов.
В этом коротком посте я подробно напишу, как можно без труда запустить узел Monero на сервере Linux, наиболее часто используемой для создания виртуальных приватных серверов (VPS) операционной системы. В качестве дистрибутива Linux я настоятельно рекомендую использовать Debian или Ubuntu. По крайней мере, в рамках данного руководства предполагается, что вы пользуетесь одним из них."/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" rel="home">
			<div class="logo__item logo__imagebox">
					<img class="logo__img" src="/img/logo.png">
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Меню</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">Что такое Monero (XMR)?</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/news/">
				
				<span class="menu__text">Новости</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/articles/">
				
				<span class="menu__text">Статьи</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/library/">
				
				<span class="menu__text">Библиотека</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/manuals/">
				
				<span class="menu__text">Руководства и инструкции</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/services/">
				
				<span class="menu__text">Полезные ссылки и сервисы</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Запуск узла Monero (продвинутая версия руководства)</h1>
			<div class="post__meta meta"><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B0/" rel="category">Руководства</a>
	</span>
</div></div>
		</header>
		
<div class="post__toc toc">
	<div class="toc__title">Содержимое страницы</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#_введение_"><em>Введение​</em></a></li>
    <li><a href="#_рекомендуемые-параметры-аппаратного-обеспечения_"><em>Рекомендуемые параметры аппаратного обеспечения​</em></a></li>
    <li><a href="#_зачем-запускать-собственный-узел-monero_"><em>Зачем запускать собственный узел Monero?​</em></a></li>
    <li><a href="#_обновление-и-установка-необходимых-пакетов_"><em>Обновление и установка необходимых пакетов​</em></a></li>
    <li><a href="#_начальное-усиление-защиты-посредством-ufw_"><em>Начальное усиление защиты посредством UFW​</em></a></li>
    <li><a href="#_загрузка-и-установка-monerod_"><em>Загрузка и установка monerod​</em></a></li>
    <li><a href="#_установка-скрипта-systemd-monerod_"><em>Установка скрипта systemd monerod​</em></a></li>
    <li><a href="#_обновление-узла-monero_"><em>Обновление узла Monero​</em></a></li>
    <li><a href="#_передача-команд-вашему-узлу_"><em>Передача команд вашему узлу​</em></a></li>
    <li><a href="#_перенаправление-портов_"><em>Перенаправление портов​</em></a></li>
    <li><a href="#_использование-анонимных-сетей_"><em>Использование анонимных сетей​</em></a>
      <ul>
        <li><a href="#_tor_"><em>Tor</em></a></li>
      </ul>
    </li>
    <li><a href="#_подключение-к-вашему-новому-удалённому-узлу_"><em>Подключение к вашему новому удалённому узлу​</em></a></li>
    <li><a href="#_несколько-полезных-cli-инструментов-linux_"><em>Несколько полезных CLI инструментов Linux​</em></a></li>
    <li><a href="#_заключение_"><em>Заключение​</em></a></li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<h2 id="_введение_"><em>Введение​</em></h2>
<p>Принимая во внимание <a href="https://sethforprivacy.com/posts/moneros-ongoing-network-attack/">постоянные атаки на сеть Monero</a>, настало время пользователям задуматься о создании <a href="https://www.monerooutreach.org/monero_best_practices/your_own_node.html">собственных узлов</a>.</p>
<p>В этом коротком посте я подробно напишу, как можно без труда запустить узел Monero на сервере Linux, наиболее часто используемой для создания виртуальных приватных серверов (VPS) операционной системы. В качестве дистрибутива Linux я настоятельно рекомендую использовать Debian или Ubuntu. По крайней мере, в рамках данного руководства предполагается, что вы пользуетесь одним из них.</p>
<p>Также в этом руководстве допускается, что вы купили и применили SSH к выбранному вами VPS/хосту. Тем не менее, если вам требуется помощь, чтобы начать, вот несколько хороших ссылок, которые помогут вам:</p>
<ul>
<li><a href="https://www.getmonero.org/community/merchants/#hosting">Хостинг сервисов, принимающих Monero</a>
<ul>
<li>Возможные опции хостинга VPS при сохранении возможности оплаты в Monero с указанием всех «за» и «против» для каждой такой опции</li>
</ul>
</li>
<li><a href="https://www.hetzner.com/dedicated-rootserver">Выделенные серверы Hetzner</a>
<ul>
<li>Надёжный и недорогой сервер в Германии. Провайдер (пока что!) не принимает Monero, но предлагает широкий выбор быстрых узлов.</li>
</ul>
</li>
<li><a href="https://www.pragmaticlinux.com/2020/07/setup-a-minimal-debian-10-buster-server-as-a-linode-vps/">Простое руководство по развёртыванию Linode</a>
<ul>
<li>Если вы используете Linode, пожалуйста, воспользуйтесь моей <a href="https://www.linode.com/?r=c956dbb75d14063251557a0e5003efb5ceacc74d">реферальной ссылкой</a>, и мы вместе получим соответствующий бонус.</li>
</ul>
</li>
</ul>
<p>Если вы пользуетесь собственным домашним оборудованием, это руководство в целом касается и вас, если на этом оборудовании установлена Ubuntu/Debian.</p>
<h2 id="_рекомендуемые-параметры-аппаратного-обеспечения_"><em>Рекомендуемые параметры аппаратного обеспечения​</em></h2>
<p>Полный узел:</p>
<ul>
<li>2+ vCPU/ядра;</li>
<li>4GB+ RAM;</li>
<li>175GB+ SSD.</li>
</ul>
<p>Обрезанный узел <em>(*)</em>:</p>
<ul>
<li>2+ vCPU/ядра;</li>
<li>4GB+ RAM;</li>
<li>75GB+ SSD.</li>
</ul>
<p><em>(*) Вариант с обрезанным узлом позволяет создать собственный узел Monero и не тратить при этом много дискового пространства. Более подробная информация содержится в статье Moneropedia, посвящённой обрезанию.</em></p>
<p><em><strong>Примечание:</strong> Если у вас есть возможность обеспечить неограниченную пропускную способность, не забудьте увеличить значения ограничения пропускной способности в конфигурационных файлах, что ускорит начальную синхронизацию и повысит общую пропускную способность всей сети Monero.​</em></p>
<h2 id="_зачем-запускать-собственный-узел-monero_"><em>Зачем запускать собственный узел Monero?​</em></h2>
<p>В основе сети Monero лежит распределённая сеть узлов Monero, каждый из которых подтверждает транзакции и транслирует их остальным участникам сети, а также помогает новым узлам просто и быстро синхронизироваться согласно текущему состоянию сети.</p>
<p>Запуск собственного узла Monero помогает не только усилить гарантии своей приватности на сетевом уровне, но также и повысить уровень децентрализации, стабильность и скорость сети Monero.</p>
<p>Каждый узел может реализовывать два разных сервиса, каждый из которых уникальным образом положительно влияет на работу сети:</p>
<ul>
<li>одноранговый (p2p) порт (18080 по умолчанию): этот порт позволяет другим узлам сети соединяться с вашим узлом, чтобы скачать блокчейн и отправить вам транзакции, которые прошли валидацию и которых у вас ещё нет. Это также повышает уровень приватности сети, так как узел участвует в трансляции транзакции в соответствии с протоколом <a href="https://www.monerooutreach.org/stories/dandelion.html">Dandelion++</a>;</li>
<li>порт удаленного вызова процедур (RPC) (18089 по умолчанию с ограниченным доступом): доступ к этому порту (особенно с аргументом публичного узла) позволяет другим пользователям сети, особенно тем, которые используют мобильные кошельки или GUI-кошелёк в «простом» режиме, подключаться к вашему узлу, чтобы синхронизировать свои кошельки, не запуская при этом собственный полный узел локально.</li>
</ul>
<p>В данном руководстве мною приводятся только те конфигурационные файлы и команды Docker, которые открывают порт p2p, поскольку это ключевым образом помогает сети. Вы можете смело использовать один из указанных ниже конфигурационных файлов с аргументом публичного узла, если вы также хотите, чтобы другие тоже узнали о вашем порте RPC с ограниченным доступом.</p>
<p>Вы можете либо развернуть <code>monerod</code> <a href="https://sethforprivacy.com/guides/run-a-monero-node/">в виде контейнера Docker</a>, либо настроить узел посредством systemd и при помощи «официальных» двоичных файлов, указанных ниже.</p>
<p><em><strong>Примечание</strong>: Если вы хотите воспользоваться исходным кодом, а не скачивать и верифицировать двоичные файлы, ознакомьтесь с великолепным <a href="https://gist.github.com/tannerdsilva/071100b6b7f5e2903b2c4ba232bccd68">руководством от tannerdsilva</a>.</em></p>
<h2 id="_обновление-и-установка-необходимых-пакетов_"><em>Обновление и установка необходимых пакетов​</em></h2>
<p>Прежде всего нам потребуется установить несколько инструментов, которые понадобятся нам позже:</p>
<pre tabindex="0"><code>sudo apt-get update &amp;&amp; sudo apt-get upgrade -y
sudo apt-get install -y ufw gpg wget
</code></pre><h2 id="_начальное-усиление-защиты-посредством-ufw_"><em>Начальное усиление защиты посредством UFW​</em></h2>
<p>Мы гарантируем простую защиту системы, ограничивая брандмауэр доступом только к тем портам, что необходимы для SSH и <code>monerod</code>, используя UFW.</p>
<p>Отличная инструкция, которая поможет начать работу с UFW, опубликована на сайте <a href="https://www.digitalocean.com/community/tutorials/how-to-setup-a-firewall-with-ufw-on-an-ubuntu-and-debian-cloud-server">DigitalOcean</a>.</p>
<p>Чтобы добавить некоторые основные правила UFW и включить брандмауэр, выполните следующие команды:</p>
<pre tabindex="0"><code># Отключение всех не обозначенных в качестве разрешённых портов
sudo ufw default deny incoming
sudo ufw default allow outgoing

# Открытие доступа SSH
sudo ufw allow ssh

# Открытие доступа к p2p порту monerod
sudo ufw allow 18080/tcp

# Открытие ограниченного доступа к RPC порту monerod
sudo ufw allow 18089/tcp

# Включение UFW
sudo ufw enable
</code></pre><h2 id="_загрузка-и-установка-monerod_"><em>Загрузка и установка monerod​</em></h2>
<p>Создайте системного пользователя и директории для конфигурации Monero, PID и файлов журнала.</p>
<pre tabindex="0"><code># Создание системного пользователя и группы для запуска run monerod как
sudo addgroup --system monero
sudo adduser --system monero --home /var/lib/monero

# Создание необходимых директорий для monerod
sudo mkdir /var/run/monero
sudo mkdir /var/log/monero
sudo mkdir /etc/monero

# Создание конфигурационного файла monerod
sudo touch /etc/monero/monerod.conf

# Настройка разрешений для новых директорий
sudo chown monero:monero /var/run/monero
sudo chown monero:monero /var/log/monero
sudo chown -R monero:monero /etc/monero
</code></pre><p>Загрузка и верификация последней версии двоичных файлов CLI при помощи моего руководства <em>(*)</em></p>
<p><em>(*) Полную версию кода, содержащуюся в руководстве, можно найти на GitHub.</em></p>
<pre tabindex="0"><code>wget https://gist.githubusercontent.com/sethsimmons/ad5848767d9319520a6905b7111dc021/raw/download_monero_binaries.sh
chmod +x download_monero_binaries.sh
./download_monero_binaries.sh
</code></pre><p>Установка последней версии двоичных файлов:</p>
<pre tabindex="0"><code>tar xvf monero-linux-*.tar.bz2
rm monero-linux-*.tar.bz2
sudo cp -r monero-x86_64-linux-gnu-*/* /usr/local/bin/
sudo chown -R monero:monero /usr/local/bin/monero*
</code></pre><h2 id="_установка-скрипта-systemd-monerod_"><em>Установка скрипта systemd monerod​</em></h2>
<p>Установка <code>monerod</code> посредством скрипта systemd обеспечивает возможность автоматического запуска Monero при загрузке, автоматического перезапуска при любом сбое, а также записи в указанный файл.</p>
<p>Выберите соответствующий конфигурационный файл в зависимости от того, хотите ли вы запустить полный узел или обрезанный, а также хотите ли вы, чтобы другие пользователи знали о вашем публичном узле RPC с ограниченным доступом и могли синхронизировать свои кошельки с помощью этого узла:</p>
<p><em><strong>Примечание</strong>: Рекомендуемый мной конфигурационный файл автоматически отображается полностью ниже, но по необходимости вы можете выбрать один из трёх других вариантов.​</em></p>
<p><strong><em>Конфигурационный файл monerod</em></strong></p>
<pre tabindex="0"><code># /etc/monero/monerod.conf

# Директория данных (база данных и индексы блокчейна)
data-dir=/var/lib/monero/.bitmonero       # Не забудьте сначала создать пользователя Monero

# Файл журнала
log-file=/var/log/monero/monerod.log

# Конфигурация P2P
# p2p-bind-ip=0.0.0.0                     # Привязка ко всем интерфейсам (по умолчанию)
# p2p-bind-port=18080                     # Привязка к порту, заданному по умолчанию

# Конфигурация RPC
rpc-restricted-bind-ip=0.0.0.0            # Привязка RPC с ограниченным доступом ко всем интерфейсам
rpc-restricted-bind-port=18089            # Привязка RPC с ограниченным доступом к специализированному порту с целью обеспечения отличия от RPC с неограниченным доступом, используемого по умолчанию (18081)
confirm-external-bind=1                   # Открытие узла RPC с ограниченным доступом (подтверждение)
no-igd=1                                  # Отключение перенаправления UPnP портов

# Конфигурация ZMQ
no-zmq=1

# Блокировка известных вредоносных портов из DNSBL
enable-dns-blocklist=1

# Установка предельных значений для скачивания и загрузки (по желанию)
# limit-rate-up=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
# limit-rate-down=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
</code></pre><p><strong><em>Конфигурационный файл monerod с публичным PRC c ограниченным доступом</em></strong></p>
<pre tabindex="0"><code># /etc/monero/monerod.conf

# Директория данных (база данных и индексы блокчейна)
data-dir=/var/lib/monero/.bitmonero       # Не забудьте сначала создать пользователя Monero

# Файл журнала
log-file=/var/log/monero/monerod.log

# Конфигурация P2P
# p2p-bind-ip=0.0.0.0                     # Привязка ко всем интерфейсам (по умолчанию)
# p2p-bind-port=18080                     # Привязка к порту, заданному по умолчанию

# Конфигурация RPC
public-node=1                             # Сообщение о наличии порта RPC с ограниченным доступом другим одноранговым узлам p2p сети
rpc-restricted-bind-ip=0.0.0.0            # Привязка RPC с ограниченным доступом ко всем интерфейсам
rpc-restricted-bind-port=18089            # Привязка RPC с ограниченным доступом к специализированному порту с целью обеспечения отличия от RPC с неограниченным доступом, используемого по умолчанию (18081)
confirm-external-bind=1                   # Открытие узла RPC с ограниченным доступом (подтверждение)
no-igd=1                                  # Отключение перенаправления UPnP портов

# Конфигурация ZMQ
no-zmq=1

# Блокировка известных вредоносных портов из DNSBL
enable-dns-blocklist=1

# Установка предельных значений для скачивания и загрузки (по желанию)
# limit-rate-up=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
# limit-rate-down=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
</code></pre><p><strong><em>Конфигурационный файл monerod (обрезанный узел)</em></strong></p>
<pre tabindex="0"><code># /etc/monero/monerod.conf

# Директория данных (база данных и индексы блокчейна)
data-dir=/var/lib/monero/.bitmonero  # Не забудьте сначала создать пользователя Monero

# Файл журнала
log-file=/var/log/monero/monerod.log

# Обрезание блокчейна
prune-blockchain=1

# Конфигурация P2P
# p2p-bind-ip=0.0.0.0                     # Привязка ко всем интерфейсам (по умолчанию)
# p2p-bind-port=18080                     # Привязка к порту, заданному по умолчанию

# Конфигурация RPC
public-node=1                             # Сообщение о наличии порта RPC с ограниченным доступом другим одноранговым узлам p2p сети
rpc-restricted-bind-ip=0.0.0.0            # Привязка RPC с ограниченным доступом ко всем интерфейсам
rpc-restricted-bind-port=18089            # Привязка RPC с ограниченным доступом к специализированному порту с целью обеспечения отличия от RPC с неограниченным доступом, используемого по умолчанию (18081)
confirm-external-bind=1                   # Открытие узла RPC с ограниченным доступом (подтверждение)
no-igd=1                                  # Отключение перенаправления UPnP портов

# Конфигурация ZMQ
no-zmq=1

# Блокировка известных вредоносных портов из DNSBL
enable-dns-blocklist=1

# Установка предельных значений для скачивания и загрузки (по желанию)
# limit-rate-up=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
# limit-rate-down=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
</code></pre><p><strong><em>Конфигурационный файл monerod с публичным PRC c ограниченным доступом (обрезанный узел)</em></strong></p>
<pre tabindex="0"><code># /etc/monero/monerod.conf

# Директория данных (база данных и индексы блокчейна)
data-dir=/var/lib/monero/.bitmonero       # Не забудьте сначала создать пользователя Monero

# Файл журнала
log-file=/var/log/monero/monerod.log

# Обрезание блокчейна
prune-blockchain=1

# Конфигурация P2P
# p2p-bind-ip=0.0.0.0                     # Привязка ко всем интерфейсам (по умолчанию)
# p2p-bind-port=18080                     # Привязка к порту, заданному по умолчанию

# Конфигурация RPC
public-node=1                             # Сообщение о наличии порта RPC с ограниченным доступом другим одноранговым узлам p2p сети
rpc-restricted-bind-ip=0.0.0.0            # Привязка RPC с ограниченным доступом ко всем интерфейсам
rpc-restricted-bind-port=18089            # Привязка RPC с ограниченным доступом к специализированному порту с целью обеспечения отличия от RPC с неограниченным доступом, используемого по умолчанию (18081)
confirm-external-bind=1                   # Открытие узла RPC с ограниченным доступом (подтверждение)
no-igd=1                                  # Отключение перенаправления UPnP портов

# Конфигурация ZMQ
no-zmq=1

# Блокировка известных вредоносных портов из DNSBL
enable-dns-blocklist=1

# Установка предельных значений для скачивания и загрузки (по желанию)
# limit-rate-up=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
# limit-rate-down=128000 # 128000 kB/s == 125MB/s == 1GBit/s; увеличение значения 2048 kB/s, установленного по умолчанию; повышение общей скорости p2p сети
</code></pre><p>Теперь необходимо скопировать и вставить конфигурационный файл, который вы будете использовать:
<code>sudo nano /etc/monero/monerod.conf</code></p>
<p><em><strong>Примечание:</strong> Чтобы выйти из оболочки nano и сохранить файл, нажмите <code>ctrl+x</code>.</em></p>
<p>Просто скопируйте содержание скрипта systemd, указанное ниже, и сохраните его в <code>/etc/systemd/system/monerod.service</code> при помощи vim или nano:</p>
<pre tabindex="0"><code># Создание директории и определение разрешений
####################################

# Запустить как monero:monero
User=monero
Group=monero

# /run/monero
RuntimeDirectory=monero
RuntimeDirectoryMode=0710

# /var/lib/monero
StateDirectory=monero
StateDirectoryMode=0710

# /var/log/monero
LogsDirectory=monero
LogsDirectoryMode=0710

# /etc/monero
ConfigurationDirectory=monero
ConfigurationDirectoryMode=0710

# Защитные меры
####################

# Определение приватных /tmp и /var/tmp.
PrivateTmp=true

# Установка /usr, /boot/ и /etc только для считывания в процессе.
ProtectSystem=full

# Отказ в доступе к /home, /root и /run/user
ProtectHome=true

# Отключение процесса и всех его дочерних процессов
# определение новых привилегий посредством execve().
NoNewPrivileges=true

[Install]
WantedBy=multi-user.target

sudo nano /etc/systemd/system/monerod.service
</code></pre><p><em><strong>Примечание:</strong> Чтобы выйти из оболочки nano и сохранить файл, нажмите <code>ctrl+x</code>.</em></p>
<p>Затем, чтобы запустить monerod, выполните следующее:</p>
<pre tabindex="0"><code># Загрузка нового скрипта systemd для monerod
sudo systemctl daemon-reload

# Установка запуска monerod при загрузке
sudo systemctl enable monerod

# Запуск сервиса monerod
sudo systemctl start monerod

# Дополнение журнала monerod
sudo tail -f /var/log/monero/monerod.log
</code></pre><p>Необходимо следить за тем, чтобы <code>monerod</code> был запущен надлежащим образом, и вы точно знали, что он синхронизирован с сетью!</p>
<h2 id="_обновление-узла-monero_"><em>Обновление узла Monero​</em></h2>
<p>Каждый раз при выходе новой версии вы стараетесь как можно быстрее обновить своё программное обеспечение, чтобы получить самые последние исправления, улучшения и функции.</p>
<p>Загрузите новые двоичные файлы:</p>
<pre tabindex="0"><code>cd ~
./download_monero_binaries.sh
</code></pre><p>Установите новые двоичные файлы и перезагрузите <code>monerod</code>:</p>
<pre tabindex="0"><code>rm -rf monero-x86_64-linux-gnu-*

tar xvf monero-linux-*.tar.bz2
rm monero-linux-*.tar.bz2
sudo systemctl stop monerod
sudo cp -r monero-x86_64-linux-gnu-*/* /usr/local/bin/
sudo chown -R monero:monero /usr/local/bin/monero*
sudo systemctl start monerod
</code></pre><p>Выполнение этих команд позволит вам скачать самую последнюю версию двоичных файлов, заменить ими старые и перезапустить <code>monerod</code> в его новой версии!</p>
<h2 id="_передача-команд-вашему-узлу_"><em>Передача команд вашему узлу​</em></h2>
<p><code>monerod</code> поддерживает локальную отправку команд, что позволяет получать дополнительную информацию о статусе <code>monerod</code>, задавать ограничения пропускной способности, ограничения для одноранговых узлов и т. д.</p>
<p>Полный список команд, начиная с версии <code>v0.17.1.8</code>, можно найти ниже или воспользовавшись <code>monerod</code> help.</p>
<p><strong><em>Вывод команды monerod help</em></strong></p>
<pre tabindex="0"><code>Monero 'Oxygen Orion' (v0.17.1.8-release)

Commands:
  alt_chain_info [blockhash]
  apropos &lt;keyword&gt; [&lt;keyword&gt; ...]
  ban [&lt;IP&gt;|@&lt;filename&gt;] [&lt;seconds&gt;]
  banned &lt;address&gt;
  bans
  bc_dyn_stats &lt;last_block_count&gt;
  check_blockchain_pruning
  diff
  exit
  flush_cache [bad-txs] [bad-blocks]
  flush_txpool [&lt;txid&gt;]
  hard_fork_info
  help [&lt;command&gt;]
  hide_hr
  in_peers &lt;max_number&gt;
  is_key_image_spent &lt;key_image&gt;
  limit [&lt;kB/s&gt;]
  limit_down [&lt;kB/s&gt;]
  limit_up [&lt;kB/s&gt;]
  mining_status
  out_peers &lt;max_number&gt;
  output_histogram [@&lt;amount&gt;] &lt;min_count&gt; [&lt;max_count&gt;]
  pop_blocks &lt;nblocks&gt;
  print_bc &lt;begin_height&gt; [&lt;end_height&gt;]
  print_block &lt;block_hash&gt; | &lt;block_height&gt;
  print_cn
  print_coinbase_tx_sum &lt;start_height&gt; [&lt;block_count&gt;]
  print_height
  print_net_stats
  print_pl [white] [gray] [pruned] [publicrpc] [&lt;limit&gt;]
  print_pl_stats
  print_pool
  print_pool_sh
  print_pool_stats
  print_status
  print_tx &lt;transaction_hash&gt; [+hex] [+json]
  prune_blockchain
  relay_tx &lt;txid&gt;
  rpc_payments
  save
  set_bootstrap_daemon (auto | none | host[:port] [username] [password])
  set_log &lt;level&gt;|&lt;{+,-,}categories&gt;
  show_hr
  start_mining &lt;addr&gt; [&lt;threads&gt;|auto] [do_background_mining] [ignore_battery]
  status
  stop_daemon
  stop_mining
  sync_info
  unban &lt;address&gt;
  update (check|download)
  version
</code></pre><p>Если вы хотите ввести команду, просто запустите <code>monerod name_of_command</code>, и он автоматически подключится к демону, выполнит команду и распечатает результаты выполнения этой команды в инструменте командной строки.
Вот несколько команд, которые я использую наиболее часто:</p>
<ul>
<li><code>monerod status</code>: получение краткой информации о состоянии <code>monerod</code>, включая информацию о количестве пиров (как входящих, так и исходящих), высоте блока, состоянии синхронизации и версии;</li>
<li><code>monerod sync_info</code>: отображение списка пиров с информацией об их состоянии и о том, как ваш узел синхронизируется с ними;</li>
<li><code>monerod print_net_stats</code>: отображение сетевой статистики с момента запуска <code>monerod</code>, включая информацию об общем объёме входящего и исходящего трафика, средней скорости и заданных ограничениях;</li>
<li><code>monerod update check</code>: проверка наличия обновлённой версии <code>monerod</code>.</li>
</ul>
<h2 id="_перенаправление-портов_"><em>Перенаправление портов​</em></h2>
<p>Если вы решите воспользоваться этим руководством, создавая узел на устройстве в своей домашней сети, вам необходимо обязательно перенаправить порты <code>18080/tcp</code> и <code>18089/tcp</code> посредством маршрутизатора или же <a href="https://blog.sethforprivacy.com/guides/run-a-monero-node/#tor">используя анонимную сеть, такую как Tor</a>.</p>
<p>Хороший основной сайт с множеством руководств по конкретным маршрутизаторам можно найти по адресу <a href="https://portforward.com/router.htm">portforward.com</a>. Просто следует убедиться в том, что вы выбрали правильную марку и модель маршрутизатора, а затем открыть порты 18080/18089, но только для TCP.</p>
<h2 id="_использование-анонимных-сетей_"><em>Использование анонимных сетей​</em></h2>
<h3 id="_tor_"><em>Tor</em></h3>
<p>Если вы хотите также открыть доступ к своему RPC порту через Tor в качестве скрытого сервиса (Hidden Service), выполните несколько приведённых ниже команд. Это обеспечивает доступ к вашему порту RPC через Tor, минуя выходные узлы.</p>
<ul>
<li>Установка Tor</li>
</ul>
<pre tabindex="0"><code># Установка демона Tor
sudo apt-get install tor
</code></pre><ul>
<li>Создание необходимой директории</li>
</ul>
<pre tabindex="0"><code>sudo mkdir /var/lib/tor/hidden_service
sudo chown debian-tor:debian-tor /var/lib/tor/hidden_service
</code></pre><ul>
<li>Редактирование конфигурационного файла torrc</li>
</ul>
<pre tabindex="0"><code># Добавление конфигурационных строк в /etc/tor/torrc для включения HiddenService узла RPC с ограниченным доступом
echo &quot;## Tor Monero RPC HiddenService
HiddenServiceDir /var/lib/tor/hidden_service/monero-rpc
HiddenServicePort 18089 127.0.0.1:18089&quot; | sudo tee -a /etc/tor/torrc
</code></pre><ul>
<li>Перезапуск Tor и получение адреса HiddenService</li>
</ul>
<pre tabindex="0"><code>sudo systemctl restart tor
sudo cat /var/lib/tor/hidden_service/monero-rpc/hostname
</code></pre><p>Строка, позволяющая получить результат ввода последней команды в вашей новой Monero RPC Hidden Service. Но не забудьте использовать порт <code>18089</code> при соединении с ней!</p>
<p><em><strong>Примечание:</strong> Чтобы проверить возможность подключения, просто зайдите на http://replacewithnewonionaddress:18089/get_info и убедитесь, что текстовый блок был получен вами обратно.​</em></p>
<h2 id="_подключение-к-вашему-новому-удалённому-узлу_"><em>Подключение к вашему новому удалённому узлу​</em></h2>
<p>Тут всё будет зависеть от кошелька, выбранного вами для использования. Но обычно это просто подразумевает указание IP-адреса вашего узла (либо вашего домашнего IP-адреса, либо адреса вашего хоста, выделенного VPS) или лукового адреса.</p>
<p>Здесь вы найдёте <a href="https://www.getmonero.org/resources/user-guides/remote_node_gui.html">пример</a> того, как это сделать, в основном десктоп-кошельке.</p>
<h2 id="_несколько-полезных-cli-инструментов-linux_"><em>Несколько полезных CLI инструментов Linux​</em></h2>
<p>Ниже приведены некоторые из моих любимых инструментов для общего использования CLI под Linux. Надеюсь, они помогут вам в обращении с CLI и позволят более внимательно следить за своим узлом!</p>
<ul>
<li><a href="https://ohmyz.sh/">Oh My Zsh</a> - Будучи превосходной заменой оболочек bash/sh, Oh My Zsh обеспечивает гораздо лучше выделение информации, усовершенствованные функции и поддерживает автоматические обновления через git.</li>
<li><a href="https://humdi.net/vnstat/">vnstat</a> - Простой CLI инструмент для наблюдения и просмотра показателей использования пропускной способности.</li>
<li><a href="https://htop.dev/">htop</a> - Обеспечивает отличную общую картину использования системных ресурсов процессами и гораздо более читабелен, чем <code>top</code>.</li>
<li><a href="https://www.vanheusden.com/multitail/">multitail</a> - Гораздо более полнофункциональный способ просмотра журналов (в частности, имеется возможность просмотра более одного журнала за раз).</li>
</ul>
<h2 id="_заключение_"><em>Заключение​</em></h2>
<p>Надеюсь, это руководство сделает процесс создания удаленного узла на VPS проще для вас. Также вскоре мною планируется публикация других подобных руководств.</p>
<p>Я использовал команды и информацию, содержащиеся в данном руководстве, чтобы запустить новые удалённые узлы на Linode и Hetzner. Вы можете свободно пользоваться им для синхронизации своего кошелька, добавить его в качестве приоритетного узла и т. д.:
<code>node-1.sethforprivacy.com:18089</code> (высокопроизводительный узел на Hetzner, расположенный во Франкфурте, Германия)</p>
<p>Также доступен как HiddenService в сети Tor по адресу:
<code>rbpgdckle3h3vi4wwwrh75usqtoc5r3alohy7yyx57isynvay63nacyd.onion:18089</code></p>
<p>Если у вас есть какие-либо вопросы, если вы считаете, что какой-либо шаг требует дополнительного разъяснения, или же вам нужна помощь в настройке и запуске, вы можете связаться со мной через <a href="https://sethforprivacy.com/about/#how-to-contact-me">Twitter, Matrix или по электронной почте</a>.</p>

		</div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/manual/how-to-run-monero-node/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Назад</span>
			<p class="pager__title">Запуск узла Monero (упрощённая версия руководства)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/manual/how-run-and-mining-p2pool/" rel="next">
			<span class="pager__subtitle">Вперед&thinsp;»</span>
			<p class="pager__title">Запуск и майнинг с помощью узла P2Pool</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Недавние публикации</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/post/2021-12-06-vulnerability-multisig/">В коде multisig-кошелька Monero обнаружена ошибка</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2021-12-04-monero-gui-0.17.3.0-released/">Доработанная версия Monero GUI 0.17.3.0 Oxygen Orion</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2021-12-04-monero-0.17.3.0-released/">Доработанная промежуточная версия Monero 0.17.3.0 Oxygen Orion</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2021-11-19-kraken-delist-monero-for-uk-customers/">Kraken планирует исключить Monero из списка поддерживаемых в Великобритании валют уже к концу ноября</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2021-11-05-p2pool-1.3.1-released/">Релиз P2Pool v1.3.1</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Категории</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item">
				<a class="widget__link" href="/categories/%D0%B6%D1%83%D1%80%D0%BD%D0%B0%D0%BB-%D0%B2%D1%81%D1%82%D1%80%D0%B5%D1%87%D0%B8/">Журнал встречи</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%D0%BD%D0%BE%D0%B2%D0%BE%D1%81%D1%82%D0%B8/">Новости</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B0/">Руководства</a></li>
			<li class="widget__item">
				<a class="widget__link" href="/categories/%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8/">Статьи</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Теги</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/breaking-monero/" title="Breaking Monero">Breaking Monero</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cake-wallet/" title="Cake Wallet">Cake Wallet</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ccs/" title="CCS">CCS</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/cdc-36c3/" title="CDC 36c3">CDC 36c3</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/ciphertrace/" title="CipherTrace">CipherTrace</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/def-con-2021/" title="DEF CON 2021">DEF CON 2021</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/farcaster/" title="Farcaster">Farcaster</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/feather-wallet/" title="Feather Wallet">Feather Wallet</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/haveno/" title="Haveno">Haveno</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/konferenco/" title="Konferenco">Konferenco</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/monero-gui/" title="Monero GUI">Monero GUI</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/monero-outreach/" title="Monero Outreach">Monero Outreach</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/monerujo/" title="Monerujo">Monerujo</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mpwg/" title="MPWG">MPWG</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/p2pool/" title="P2Pool">P2Pool</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%B0%D1%82%D0%BE%D0%BC%D0%B0%D1%80%D0%BD%D1%8B%D0%B5-%D1%81%D0%B2%D0%BE%D0%BF%D1%8B/" title="Атомарные свопы">Атомарные свопы</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%B2%D0%B7%D0%BB%D0%BE%D0%BC/" title="Взлом">Взлом</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%B2%D0%B8%D1%80%D1%83%D1%81/" title="Вирус">Вирус</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%B6%D1%83%D1%80%D0%BD%D0%B0%D0%BB-%D0%B2%D1%81%D1%82%D1%80%D0%B5%D1%87%D0%B8/" title="Журнал встречи">Журнал встречи</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%BD%D0%B0%D1%83%D1%87%D0%BD%D0%BE-%D1%84%D0%B0%D0%BD%D1%82%D0%B0%D1%81%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D1%80%D0%B0%D1%81%D1%81%D0%BA%D0%B0%D0%B7/" title="Научно-фантастический рассказ">Научно-фантастический рассказ</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0/" title="Ошибка">Ошибка</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 .
			<span class="footer__copyright-credits">Информационно-новостной сайт русскоязычного сообщества Monero. <a href="/services/#_поддержать-xmrru_" rel="nofollow noopener" target="_blank">Пожертвовать</a>  на развитие проекта XMR.RU.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="/js/custom.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>